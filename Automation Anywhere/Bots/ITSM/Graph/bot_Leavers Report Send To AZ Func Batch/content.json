{"triggers":[],"nodes":[{"uid":"52f7a19d-e4a8-44a8-b91f-488168bfcdca","commandName":"javascript.commands.openScript","packageName":"JavaScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"getDate"}},{"name":"scriptOption","value":{"type":"STRING","string":"SCRIPT"}},{"name":"script","value":{"type":"STRING","string":"function getDate(){\n  var d = new Date();\n  d = d.toLocaleDateString(\"en-US\");\n  \n  var response = d;\n  return response;\n}"}}]},{"uid":"7e91bdd2-a35c-491f-a8ac-5b69387ae353","commandName":"javascript.commands.executeFunction","packageName":"JavaScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"getDate"}},{"name":"functionName","value":{"type":"STRING","string":"getDate"}}],"returnTo":{"type":"VARIABLE","variableName":"dateName"}},{"uid":"04fd249a-afd8-47f6-acf6-36b44c322cc8","commandName":"javascript.commands.closeScript","packageName":"JavaScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"getDate"}}]},{"uid":"26cae29f-dafe-414a-90f5-45fdabbac049","commandName":"OpenCSVTXT","packageName":"CsvTxt","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"StringJsonFile"}},{"name":"filePath","value":{"type":"FILE","expression":"file:///C:/AAE_files/leavers_report/Leavers%20Report%20StringResult%20-%20$dateName$.txt"}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"delimeter","value":{"type":"STRING","string":"newLine"}},{"name":"trimLeadingSpace","value":{"type":"BOOLEAN","boolean":false}},{"name":"trimTrailingSpace","value":{"type":"BOOLEAN","boolean":false}},{"name":"encoding","value":{"type":"STRING","string":"UTF-8"}}]},{"uid":"363198ce-80f2-4eb3-874a-7124a11fb664","commandName":"ReadFromCsvTxt","packageName":"CsvTxt","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"StringJsonFile"}}],"returnTo":{"type":"VARIABLE","variableName":"StringJsonFileAsTable"}},{"uid":"26d52b23-c0ec-4ee3-ba0e-e16ccdb28c9e","commandName":"CloseCsvTxt","packageName":"CsvTxt","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"StringJsonFile"}}]},{"uid":"5b0e8f3f-8f08-4638-8b41-fc50e2ffd666","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$StringJsonFileAsTable[0][0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"stringJsonFile"}},{"uid":"b536dfb4-a88c-43bf-945e-bfef631d057a","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$stringJsonFile$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]},{"uid":"93fa5fa1-1625-47b7-935a-9ee41a3e6132","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"74582fb7-a8c8-437e-a935-e605cecab74f","commandName":"restPost","packageName":"Rest","disabled":false,"attributes":[{"name":"uriOption","value":{"type":"STRING","string":"text"}},{"name":"uri","value":{"type":"STRING","string":"https://nexthink-dw-functionapp-gb-prod.azurewebsites.net/api/itsm-leavers-report"}},{"name":"authenticationMode","value":{"type":"STRING","string":"NoAuthentication"}},{"name":"customHeaders","value":{"type":"LIST","list":[{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"Content-Type"}},{"key":"value","value":{"type":"STRING","string":"application/json"}}]},{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"x-functions-key"}},{"key":"value","value":{"type":"CREDENTIAL","credential":{"name":"x-functions-key","lockerName":"VA_locker","attributeName":"AAE_key"}}}]}]}},{"name":"headerContentType","value":{"type":"STRING","string":"application/json"}},{"name":"parameterOption","value":{"type":"STRING","string":"text"}},{"name":"jsonPostParameters","value":{"type":"STRING","expression":"{\n\"members\": \"$stringJsonFile$\",\n\"debug\": true\n}\n"}}],"returnTo":{"type":"VARIABLE","variableName":"itsm-leavers-report-response"}}],"branches":[{"uid":"ea957fe9-dd09-4548-8db3-6ad699d271db","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}]},{"uid":"37d2e1ba-c3ca-4343-92a7-2eb882260737","commandName":"javascript.commands.openScript","packageName":"JavaScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"getHttpResponse"}},{"name":"scriptOption","value":{"type":"STRING","string":"SCRIPT"}},{"name":"script","value":{"type":"STRING","string":"function getHttpResponse(httpResp){\n  var response = JSON.stringify(httpResp); \n  return response;\n}"}}]},{"uid":"3909d755-8a52-4c5f-964b-6bfbbdb0984f","commandName":"javascript.commands.executeFunction","packageName":"JavaScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"getHttpResponse"}},{"name":"functionName","value":{"type":"STRING","string":"getHttpResponse"}},{"name":"argument","value":{"type":"VARIABLE","variableName":"itsm-leavers-report-response"}}],"returnTo":{"type":"VARIABLE","variableName":"httpResponse"}},{"uid":"ecfa9dc2-f935-428c-b5ae-263dfc381fe7","commandName":"javascript.commands.closeScript","packageName":"JavaScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"getHttpResponse"}}]},{"uid":"fc7132a1-b0cd-4860-81df-92cf41e9b4cd","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$httpResponse$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"20"}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"dateName","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"StringJsonFileAsTable","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"stringJsonFile","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"itsm-leavers-report-response","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"httpResponse","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":[],"packages":[{"name":"CsvTxt","version":"2.3.0-20200825-071131"},{"name":"ErrorHandler","version":"2.1.0-20200831-031055"},{"name":"JavaScript","version":"2.1.0-20200831-031525"},{"name":"MessageBox","version":"2.1.0-20200831-031541"},{"name":"Rest","version":"3.1.0-20200824-092129"},{"name":"String","version":"3.1.0-20200831-031943"}],"workItemTemplateName":null}